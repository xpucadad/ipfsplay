<html>
<body>
<h1>Hello L4R World!</h1>
<h5>V1.2</h5>
<p>This web page is being served from the ipfs p2p network. This is, there
  is no single server on which it is hosted.</p>
<h2>Here is the setup:</h2>
<ul>
<li>The page source is in the file website/index.html.</li>
<li>The website folder is added to ipfs, generating a hash $WEBSITE_HASH: "ipfs add -r website". The -r will recurse to all files in the website folder.</li>
<li>The hash is published to the peer id: "ipfs name publish $WEBSITE_HASH".</li>
<li>A DNS Cname record is created to map ipfstest.looking4reality.net to gateway.ipfs.io.</li>
<li>A DNS Text record is created which maps the site url prepended with the special ipfs "_dnslink.". That is defining a text record with the host set to "_dnslink.ipfstest.looking4reality.net", and the text set to "dnslink=ipns/$PEER_ID", where $PEER_ID is the local ipfs daemon's peer id. This is where the name was published to above.</li>
</ul>
<h2>The page is retrieved as follows:</h2>
<ol>
<li>User provivdes the following URL to a browser: http://ipfstest.looking4reality.net</li>
<li>Browser asks dns for the information for the URL.</li>
<li>DNS uses the Cname to get the target url "gateway.ipfs.io", and returns it and the text record that defines the special _dnslink to the browser.</li>
<li>The browser sends the request to gateway.ipfs.io (from Cname) along with the special _dnslink text record.</li>
<li>The gateway gets the ipns dnslink from the text record and uses this to retrieve the peer id.</li>
<li>The gateway uses the peer id to look up the published hash ($WEBSITE_HASH above) using ipns.</li>
<li>The gateway retrieves the ipfs content using the $WEBSITE_HASH and returns it to the browser.</li>
<li>The browser renders the site.</li>
</ol>
<h2>Updating the site</h2>
<p>To update the site:</p>
<ol>
  <li>The content of the site (in the website folder) is updated.</li>
  <li>A new $WEBSITE_HASH is generated by adding the website to IPFS: "ipfs add -r website".</li>
  <li>The new $WEBSITE_HASH is published to the peer id: "ipfs name publish $WEBSITE_HASH".</li>
  <li>Copy the above 2 commands and results from the terminal and paste them into the file "website hashes.txt".
  <li>The updated site should now be served for the URL http://ipfstest.looking4reality.net.</li>
</ol>
<p>Note that if you move the daemon to another server, the peer id you got when running the ipfs daemon will be different. Therefore you will need to change the target in the DNS text record's dnslink to use the peer id from the new server.</p>
<hr>
<p>This is version 1.2</p>
<p><a href="./history.html">Version History</a></p>
</body>
</html>
